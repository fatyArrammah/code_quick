<!DOCTYPE html>
<html>
<head>
    <title>Barcode Scanner</title>
    <script src="https://cdn.jsdelivr.net/npm/quagga@0.12.1/dist/quagga.min.js"></script>
</head>
<body>
    <div id="scanner-container"></div>
    <div id="result"></div>

    <script>
        Quagga.init({
            //inputStream : {
                //name : "Live",
                //type : "LiveStream",
                //target: document.querySelector('#scanner-container')
            //}

            inputStream: {
                type : "LiveStream",
                constraints: {
                    width: {min: 640},
                    height: {min: 480},
                    facingMode: "environment",
                    aspectRatio: {min: 1, max: 2}
                }
            }
            ,
            locator: {
                patchSize: 'large',  // Adjust this based on your needs
                halfSample: false      // Set to false if you have performance to spare for potentially increased accuracy
            },
            decoder : {
                readers : ["code_128_reader", "ean_reader", "ean_8_reader", "code_39_reader", "code_39_vin_reader", "codabar_reader", "upc_reader", "upc_e_reader", "i2of5_reader"]
            }
                }, function(err) {
            if (err) {
                console.log(err);
                return
            }
            console.log("Initialization finished. Ready to start");
            Quagga.start();
        });

        Quagga.onDetected(function(data) {
            var code = data.codeResult.code;
            document.getElementById('result').textContent = 'Detected barcode: ' + code;
            checkCode(code);
        });

        function checkCode(code) {
            var url = 'https://script.google.com/macros/s/AKfycbyMENjQIlpVOFWEYWj_lBSdp2pmzMkIGrM_Fnl-R5rINVEjVjykwXdOlL2aWS8BCDYDcA/exec?code=' + encodeURIComponent(code);
            
            fetch(url)
                .then(response => response.text())
                .then(data => {
                    document.getElementById('result').innerText = data;
                })
                .catch(error => console.error('Error:', error));
        }

    </script>
</body>
</html>
